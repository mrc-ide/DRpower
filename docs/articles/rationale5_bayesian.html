<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The DRpower model • DRpower</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="The DRpower model">
<meta property="og:description" content="DRpower">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DRpower</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    How it works
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/rationale1_background.html">Background</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Analysing data</li>
    <li>
      <a href="../articles/rationale2_issue.html">CIs and overdispersion</a>
    </li>
    <li>
      <a href="../articles/rationale3_design_effect.html">The design effect</a>
    </li>
    <li>
      <a href="../articles/rationale4_weaknesses.html">Weaknesses with the traditional approach</a>
    </li>
    <li>
      <a href="../articles/rationale5_bayesian.html">A Bayesian approach</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Designing a study</li>
    <li>
      <a href="../articles/rationale6_master_protocol.html">Sample size calculation in the 2020 master protocol</a>
    </li>
    <li>
      <a href="../articles/rationale7_ztest.html">The one-sample z-test</a>
    </li>
    <li>
      <a href="../articles/rationale8_power.html">Power and sample size in the DRpower model</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/installation.html">Installation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/tutorial_design.html">Designing a study</a>
    </li>
    <li>
      <a href="../articles/tutorial_analysis.html">Analysing data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Misc
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/mathematical_details.html">Mathematical details</a>
    </li>
    <li>
      <a href="../articles/historical_analysis.html">Historical analysis</a>
    </li>
    <li>
      <a href="../articles/summarise_prevalence.html">How to summarise the prevalence</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mrc-ide/DRpower/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>The DRpower model</h1>
                        <h4 data-toc-skip class="author">Bob Verity</h4>
            
            <h4 data-toc-skip class="date">Last updated: 25 Jul
2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mrc-ide/DRpower/blob/HEAD/vignettes/rationale5_bayesian.Rmd" class="external-link"><code>vignettes/rationale5_bayesian.Rmd</code></a></small>
      <div class="hidden name"><code>rationale5_bayesian.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="a-bayesian-approach">5. A Bayesian approach<a class="anchor" aria-label="anchor" href="#a-bayesian-approach"></a>
</h2>
<p>In DRpower we take a different approach to analysis that deals with
all of the issues listed in the previous section. We describe the
approach at a high level here, for those wanting more mathematical
details please <a href="articles/mathematical_details.html">see this
page</a>.</p>
<p>We start by assuming a <a href="https://en.wikipedia.org/wiki/Random_effects_model" class="external-link">random
effects</a> framework. Instead of assuming that all individuals have the
same probability of carrying the <em>pfhrp2/3</em> deleted strain, we
allow each cluster to have its own cluster-level prevalence. We model
the mean and the spread of this cluster-level variation using a random
effects distribution - in our case a <a href="https://en.wikipedia.org/wiki/Beta_distribution" class="external-link">beta
distribution</a> like the one shown below:</p>
<p><img src="rationale5_bayesian_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>This distribution has a mean value <span class="math inline">\(p\)</span> that represents the province-level
prevalence of deletions (i.e. the main thing we are trying to estimate).
It also has a parameter <span class="math inline">\(r\)</span> that
represents the level of intra-cluster correlation and hence
overdispersion. Larger values of <span class="math inline">\(r\)</span>
lead to more spread out distributions. Our objective is to estimate
<span class="math inline">\(p\)</span> while taking into account
uncertainty in <span class="math inline">\(r\)</span>, which we can do
very easily within a Bayesian framework. A full description of <a href="https://en.wikipedia.org/wiki/Bayesian_statistics" class="external-link">Bayesian
statistics</a> is beyond the scope of this document, but in short
we:</p>
<ol style="list-style-type: decimal">
<li>Write down the probability of the data under the model, which can be
done exactly in this case without making any approximations.</li>
<li>Come up with suitable <a href="https://en.wikipedia.org/wiki/Prior_probability" class="external-link">priors</a> on our
two unknown parameters; <span class="math inline">\(p\)</span> and <span class="math inline">\(r\)</span>. We could use historical data to help
us here, or we could try to keep our priors “diffuse” so we are guided
primarily by the new data.</li>
<li>Calculate the posterior distribution of <span class="math inline">\(p\)</span>, integrated over our uncertainty in
<span class="math inline">\(r\)</span>. Crucially, this method
<strong>takes into account everything the data tells us about
intra-cluster correlation and propagates this uncertainty into our
estimate of the prevalence</strong>.</li>
</ol>
<p>We end up with a probability distribution that describes the
plausible range of values that <span class="math inline">\(p\)</span>
could take. We can use this in many different ways, for example we can
calculate a credible interval (CrI). CrIs have a slightly different and
more direct interpretation than confidence intervals (CIs) - a 95% CrI
means there is a 95% probability that the true value lies inside this
interval (compare this with <a href="https://thestatsgeek.com/2020/11/21/interpretation-of-frequentist-confidence-intervals-and-bayesian-credible-intervals/" class="external-link">the
definition of a CI</a>). This immediately deals with the first 4 out of
5 issues listed in the previous section.</p>
<p>We can also output from the model the posterior probability that
prevalence is above the 5% threshold. We can turn this into a hypothesis
test by rejecting the null hypothesis whenever this probability is above
a certain level. This gives us a binary decision tool just like the
traditional approach, but now with all the advantages of the Bayesian
method.</p>
<p>We can run the DRpower model on our example data as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_posterior.html">get_prevalence</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_deletions</span>, N <span class="op">=</span> <span class="va">n_tested</span><span class="op">)</span></span>
<span><span class="co">#&gt;     MAP CrI_lower CrI_upper prob_above_threshold</span></span>
<span><span class="co">#&gt; 1 13.98      6.11     28.13               0.9969</span></span></code></pre></div>
<p>The first output is the <em>maximum a posteriori</em> (MAP) estimate,
which gives us a point estimate of 13.98% prevalence - very close to our
original estimate of 14% from the raw data. There are other summaries
that we might be interested in, but see <a href="articles/summarise_prevalence.html">here</a> when deciding between
them.</p>
<p>Based on the output above, we also estimate that there is a 0.9969
probability that the prevalence is above 5%. By default we recommend
using a cutoff of 0.95 when turning this into a hypothesis test, so in
this case we can reject the null hypothesis. Based on this analysis,
therefore, we have sufficient evidence to conclude that prevalence is
above our target threshold, and so a switch of RDTs is justified.</p>
<p>In summary, the DRpower model provides an alternative way of
analysing clustered prevalence data that has some advantages over
traditional methods. It can be used to calculate CrIs, and/or it can be
used in a hypothesis testing framework. The next section describes how
this framework can be used in study design.</p>
<p align="center">
<button class="btn btn-primary" onclick="window.location.href='https://mrc-ide.github.io/DRpower/articles/rationale6_master_protocol.html';">
Next topic
</button>
</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Bob Verity.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
