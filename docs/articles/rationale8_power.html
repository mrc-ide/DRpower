<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Power and Sample Size in the DRpower Model • DRpower</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Power and Sample Size in the DRpower Model">
<meta property="og:description" content="DRpower">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DRpower</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    How it works
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/rationale1_background.html">Background</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Analysing data</li>
    <li>
      <a href="../articles/rationale2_issue.html">CIs and overdispersion</a>
    </li>
    <li>
      <a href="../articles/rationale3_design_effect.html">The design effect</a>
    </li>
    <li>
      <a href="../articles/rationale4_weaknesses.html">Weaknesses with the traditional approach</a>
    </li>
    <li>
      <a href="../articles/rationale5_bayesian.html">A Bayesian approach</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Designing a study</li>
    <li>
      <a href="../articles/rationale6_master_protocol.html">Sample size calculation in the 2020 master protocol</a>
    </li>
    <li>
      <a href="../articles/rationale7_ztest.html">The one-sample z-test</a>
    </li>
    <li>
      <a href="../articles/rationale8_power.html">Power and sample size in the DRpower model</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/installation.html">Installation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/tutorial_design.html">Designing a study</a>
    </li>
    <li>
      <a href="../articles/tutorial_analysis.html">Analysing data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Misc
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/mathematical_details.html">Mathematical details</a>
    </li>
    <li>
      <a href="../articles/historical_analysis.html">Historical analysis</a>
    </li>
    <li>
      <a href="../articles/summarise_prevalence.html">How to summarise the prevalence</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mrc-ide/DRpower/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="rationale8_power_files/kePrint-0.0.1/kePrint.js"></script><link href="rationale8_power_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Power and Sample Size in the DRpower Model</h1>
                        <h4 data-toc-skip class="author">Bob Verity</h4>
            
            <h4 data-toc-skip class="date">Last updated: 25 Oct
2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mrc-ide/DRpower/blob/HEAD/vignettes/rationale8_power.Rmd" class="external-link"><code>vignettes/rationale8_power.Rmd</code></a></small>
      <div class="hidden name"><code>rationale8_power.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="estimating-power-via-simulation">8. Estimating power via simulation<a class="anchor" aria-label="anchor" href="#estimating-power-via-simulation"></a>
</h2>
<p>The power of a hypothesis test is intrinsically linked to the method
we plan to use in our statistical analysis. We have found that if we
plan to conduct a z-test on our data then, for the parameter values
described in the 2020 master protocol, we will need 1126 samples. But
what if we change our analysis plan to the <a href="articles/rationale5_bayesian.html">Bayesian model</a> in DRpower?
Can we calculate power under this new approach?</p>
<p>The answer is both yes and no. We cannot produce a neat formula for
the power as we could for the z-test as this Bayesian model is simply
too involved. We can, however, <em>estimate</em> the power by
simulation. The approach is:</p>
<ol style="list-style-type: decimal">
<li>Choose true values of parameters like the prevalence (<span class="math inline">\(p\)</span>) and the intra-cluster correlation
(<span class="math inline">\(r\)</span>). These values represent the
alternative hypothesis that we are interested in. This is similar to
assuming a high prevalence value of 8% in the master protocol.</li>
<li>For a particular number of clusters (<span class="math inline">\(c\)</span>) and sample size per cluster (<span class="math inline">\(n\)</span>), simulate data from the beta-binomial
model. Analyse this simulated data using the DRpower method, and
establish whether we conclude that prevalence is above 5% or not.</li>
<li>Repeat this simulation-analysis step many times (hundreds or
thousands). Count the proportion of times that we come to the correct
conclusion. This proportion is our estimate of the <em>empirical
power</em>.</li>
</ol>
<p>One major advantage of the empirical power method is that it uses the
exact analysis approach that we will use on our real data, meaning there
are no approximations or fudging over uncertainty. The main downsides of
this approach are; 1) it is based on a random sample, meaning power is
only <em>estimated</em> and not calculated exactly, 2) it can take a
long time to estimate if the analysis step itself is slow. These issues
are mitigated to some extent in DRpower by running a wide range of
parameter values on the Imperial College London Department of Infectious
Disease Epidemiology computer cluster. The results are made available
with the DRpower package, one such set of results is shown below:</p>
<p><img src="rationale8_power_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>There is some random noise in this plot, but the overall trend is
clear. Power increases quickly at first and then plateaus out for larger
sample sizes. Power reaches 80% for the DRpower method at around 110
samples per cluster. In contrast, the z-test method never reaches the
80% power level.</p>
<p>Why does the DRpower model have power so much higher than the z-test?
This is not straightforward to answer, as the two approaches come from
completely different statistical philosophies, but one very important
difference is in the specific hypotheses that we are testing. In the
z-test approach we are trying to disprove a single hypothesis; that the
prevalence is <em>exactly</em> equal to the threshold. On the other
hand, in the Bayesian approach we are comparing two hypotheses; 1) the
prevalence is above the threshold, vs. 2) the prevalence is below the
threshold. By “below the threshold” we don’t mean exactly <em>on</em>
the threshold, but rather anywhere below it. This is sometimes referred
to as a <em>composite hypothesis test</em> because we are assuming a
range of values rather than a single value. This composite hypothesis is
easier to disprove because we are being less pessimistic about the
prevalence of <em>pfhrp2/3</em> deletions. So, this boils down to a
difference in assumptions under the null hypothesis. We feel that the
Bayesian perspective is justified here because a “low” prevalence of
<em>pfhrp2/3</em> deletions will often mean values below the threshold
rather than exactly on it.</p>
</div>
<div class="section level2">
<h2 id="sample-size-calculation">8.1. Sample size calculation<a class="anchor" aria-label="anchor" href="#sample-size-calculation"></a>
</h2>
<p>Once we have a power curve like the one above, we can work out what
sample size we would need to achieve any given power. For the
simulation-based approach this will be approximate because of noise in
the power curve. We take a two-step approach:</p>
<ol style="list-style-type: decimal">
<li>Use linear interpolation between a fixed set of simulations, as
shown in the plot above. Find the first value of the sample size for
which the power exceeds 80%.</li>
<li>Intuitively, we would expect per-cluster sample sizes to decrease as
the number of clusters increases. In some rare cases this method can
give the opposite result due to random fluctuations in our estimation
method. We therefore remove this effect by modifying results so that
sample size can never decrease with more clusters.</li>
<li>Sample sizes greater than 2000 are coded as <code>NA</code> because
these are prohibitively large. Sample sizes less than 5 are fixed at 5
because it would not be worth enrolling a cluster and collecting fewer
than this many samples.</li>
</ol>
<p>For an assumed ICC of 0.05 based on <a href="articles/historical_analysis.html">historical data</a>, this leads
to the sample size table shown below:</p>
<table style="width:100%; margin-left: auto; margin-right: auto;" class="table table table-striped table-hover table-condensed">
<caption>
Table of minimum sample size required per cluster in order to achieve
80% power. Columns give the assumed true prevalence of deletions (as %),
rows give the number of clusters (n_clust).
</caption>
<thead><tr>
<th style="text-align:right;border-bottom: 1px solid; border-top: 1px solid">
n_clust
</th>
<th style="text-align:right;border-bottom: 1px solid; border-top: 1px solid">
8
</th>
<th style="text-align:right;border-bottom: 1px solid; border-top: 1px solid">
9
</th>
<th style="text-align:right;border-bottom: 1px solid; border-top: 1px solid">
10
</th>
<th style="text-align:right;border-bottom: 1px solid; border-top: 1px solid">
11
</th>
<th style="text-align:right;border-bottom: 1px solid; border-top: 1px solid">
12
</th>
<th style="text-align:right;border-bottom: 1px solid; border-top: 1px solid">
13
</th>
<th style="text-align:right;border-bottom: 1px solid; border-top: 1px solid">
14
</th>
<th style="text-align:right;border-bottom: 1px solid; border-top: 1px solid">
15
</th>
<th style="text-align:right;border-bottom: 1px solid; border-top: 1px solid">
16
</th>
<th style="text-align:right;border-bottom: 1px solid; border-top: 1px solid">
17
</th>
<th style="text-align:right;border-bottom: 1px solid; border-top: 1px solid">
18
</th>
<th style="text-align:right;border-bottom: 1px solid; border-top: 1px solid">
19
</th>
<th style="text-align:right;border-bottom: 1px solid; border-top: 1px solid">
20
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
344
</td>
<td style="text-align:right;">
140
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
14
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
172
</td>
<td style="text-align:right;">
69
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
128
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
496
</td>
<td style="text-align:right;">
75
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
113
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
68
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
416
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
138
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
85
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
438
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
179
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
122
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
122
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
84
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;border-bottom: 1px solid">
20
</td>
<td style="text-align:right;border-bottom: 1px solid">
67
</td>
<td style="text-align:right;border-bottom: 1px solid">
18
</td>
<td style="text-align:right;border-bottom: 1px solid">
9
</td>
<td style="text-align:right;border-bottom: 1px solid">
6
</td>
<td style="text-align:right;border-bottom: 1px solid">
5
</td>
<td style="text-align:right;border-bottom: 1px solid">
5
</td>
<td style="text-align:right;border-bottom: 1px solid">
5
</td>
<td style="text-align:right;border-bottom: 1px solid">
5
</td>
<td style="text-align:right;border-bottom: 1px solid">
5
</td>
<td style="text-align:right;border-bottom: 1px solid">
5
</td>
<td style="text-align:right;border-bottom: 1px solid">
5
</td>
<td style="text-align:right;border-bottom: 1px solid">
5
</td>
<td style="text-align:right;border-bottom: 1px solid">
5
</td>
</tr>
</tbody>
</table>
<p>For example, if we assume the prevalence of <em>pfhrp2/3</em>
deletions is 10% in the population, and we will survey 10 clusters, then
we need a sample size of 30 per cluster (300 total).</p>
<p>Compare this with the sample size table we would get if we were using
the z-test:</p>
<table style="width:100%; margin-left: auto; margin-right: auto;" class="table table table-striped table-hover table-condensed">
<caption>
Table of minimum sample size required under the z-test analysis plan
(NOT ADVISED).
</caption>
<thead><tr>
<th style="text-align:right;border-bottom: 1px solid; border-top: 1px solid">
n_clust
</th>
<th style="text-align:right;border-bottom: 1px solid; border-top: 1px solid">
8
</th>
<th style="text-align:right;border-bottom: 1px solid; border-top: 1px solid">
9
</th>
<th style="text-align:right;border-bottom: 1px solid; border-top: 1px solid">
10
</th>
<th style="text-align:right;border-bottom: 1px solid; border-top: 1px solid">
11
</th>
<th style="text-align:right;border-bottom: 1px solid; border-top: 1px solid">
12
</th>
<th style="text-align:right;border-bottom: 1px solid; border-top: 1px solid">
13
</th>
<th style="text-align:right;border-bottom: 1px solid; border-top: 1px solid">
14
</th>
<th style="text-align:right;border-bottom: 1px solid; border-top: 1px solid">
15
</th>
<th style="text-align:right;border-bottom: 1px solid; border-top: 1px solid">
16
</th>
<th style="text-align:right;border-bottom: 1px solid; border-top: 1px solid">
17
</th>
<th style="text-align:right;border-bottom: 1px solid; border-top: 1px solid">
18
</th>
<th style="text-align:right;border-bottom: 1px solid; border-top: 1px solid">
19
</th>
<th style="text-align:right;border-bottom: 1px solid; border-top: 1px solid">
20
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
254
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
473
</td>
<td style="text-align:right;">
114
</td>
<td style="text-align:right;">
64
</td>
<td style="text-align:right;">
44
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
130
</td>
<td style="text-align:right;">
64
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
25
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
666
</td>
<td style="text-align:right;">
96
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
17
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
96
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
13
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
124
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
297
</td>
<td style="text-align:right;">
64
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
105
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
619
</td>
<td style="text-align:right;">
64
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
153
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
88
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
61
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
308
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
144
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
56
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;border-bottom: 1px solid">
20
</td>
<td style="text-align:right;border-bottom: 1px solid">
NA
</td>
<td style="text-align:right;border-bottom: 1px solid">
NA
</td>
<td style="text-align:right;border-bottom: 1px solid">
46
</td>
<td style="text-align:right;border-bottom: 1px solid">
22
</td>
<td style="text-align:right;border-bottom: 1px solid">
14
</td>
<td style="text-align:right;border-bottom: 1px solid">
11
</td>
<td style="text-align:right;border-bottom: 1px solid">
8
</td>
<td style="text-align:right;border-bottom: 1px solid">
7
</td>
<td style="text-align:right;border-bottom: 1px solid">
6
</td>
<td style="text-align:right;border-bottom: 1px solid">
5
</td>
<td style="text-align:right;border-bottom: 1px solid">
5
</td>
<td style="text-align:right;border-bottom: 1px solid">
5
</td>
<td style="text-align:right;border-bottom: 1px solid">
5
</td>
</tr>
</tbody>
</table>
<p>For the same assumption of 10% prevalence we would need 15 clusters
of 308 individuals (4620 total)!</p>
</div>
<div class="section level2">
<h2 id="how-to-choose-final-sample-sizes">8.2. How to choose final sample sizes<a class="anchor" aria-label="anchor" href="#how-to-choose-final-sample-sizes"></a>
</h2>
<p>Using the DRpower table above (not the z-test table!) we can come up
with reasonable values for the sample size per cluster. But these values
assume <em>the same</em> sample size per cluster, which is often not
true in practice. At this point, we need to switch away from simple
tables and perform a power analysis that is more bespoke to our problem.
The steps are roughly as follows:</p>
<ol style="list-style-type: decimal">
<li>Work out how many clusters are feasible within a given province
based on logistical and budgetary considerations.</li>
<li>Work out what prevalence of <em>pfhrp2/3</em> deletions you want to
power your study for. A value of 10% is a reasonable default to use
here.</li>
<li>Use these values to look up the corresponding minimum sample size
from the table above. This is your first rough estimate of sample size
per cluster.</li>
<li>Buffer these values for potential dropout. Also note that this table
gives the number of <em>confirmed malaria positive</em> individuals, but
you may want to design the study based on the total number tested, which
may be considerably higher. For example, if you suspect that 40% of
suspected malaria cases end up being confirmed then you would need to
divide your sample size by 0.4.</li>
<li>Examine whether it will be possible to recruit this many samples in
each of your sites. This may depend on things like catchment population
size, staff numbers, and malaria transmission intensity throughout the
season. It may be that in some cases it is not possible to reach these
numbers.</li>
<li>For your newly refined sample size estimates, estimate power
directly using the <code><a href="../reference/get_power_threshold.html">get_power_threshold()</a></code> function.</li>
</ol>
<p>The best way to perform all of these steps is through the <a href="https://shiny.dide.ic.ac.uk/DRpower-app/" class="external-link">interactive web app</a>.
But for those wanting to perform the same analysis in the R package, see
<a href="articles/tutorial_design.html">this tutorial</a>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Bob Verity.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
